---
title: "EastRiver_AES"
author: "CGA"
date: "March 6, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load necessary packages
library(tidyverse)
library(readxl)
# Set working directory
setwd("~/east-river/")
```

## Load spreadsheet with raw MP-ICP-AES data
```{r}
mp_raw <- read.csv("Data/MP-ICP-AES/5March2018_CA_EastRiver.csv", skip=2)

# Select certain rows
mp_select <- mp_raw[, c(1:10)]

# Change to numeric
mp_select$Intensity <- as.numeric(mp_select$Intensity)
mp_select$Concentration <- as.numeric(mp_select$Concentration)

```

## Look at standards and blanks (pre-processed with MP-ICP-AES software)
```{r}
mp_select_standards <- mp_select[mp_select$Type %in% c("STD","BLK"), ]

# Figure: standard curves
ggplot(subset(mp_select_standards, Type %in% "STD")) +
  aes(x=Concentration, y=Intensity) +
  geom_point() + geom_line() +
  facet_wrap(~Element.Label, scales="free")

```

## Look at samples
```{r}
mp_select_samples <- mp_select[mp_select$Type %in% "Sample", ]

# Take out any non-relevant samples
exclude <- which(with(mp_select_samples, Label=="Standard 7"))
mp_select_samples <- mp_select_samples[-exclude, ]

# Separate name column
mp_select_samples <- mp_select_samples %>%
  separate(Label, c("sample", "extract", "dilution"), "_")

# Figure: samples by extract, dilution
ggplot(subset(mp_select_samples, extract %in% "h20")) +
  aes(x=dilution, y=Concentration) +
  geom_boxplot() +
  facet_wrap(~Element.Label, scales="free")

ggplot(subset(mp_select_samples, extract %in% "pp")) +
  aes(x=dilution, y=Concentration) +
  geom_boxplot() +
  facet_wrap(~Element.Label, scales="free")

ggplot(subset(mp_select_samples, extract %in% "hcl")) +
  aes(x=dilution, y=Concentration) +
  geom_boxplot() +
  facet_wrap(~Element.Label, scales="free")

ggplot(subset(mp_select_samples, extract %in% "dith")) +
  aes(x=dilution, y=Concentration) +
  geom_boxplot() +
  facet_wrap(~Element.Label, scales="free")


```